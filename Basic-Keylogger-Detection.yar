import "pe"

rule Keylogger
{
    meta:
        description = "Detects keylogger activities based on API calls"
        author = "YourName"
        date = "2024-09-15"
        version = "1.0"

    strings:
        $s1 = "GetAsyncKeyState"       // Function used to capture keystrokes
        $s2 = "GetForegroundWindow"    // Used to monitor active window
        $s3 = "WriteFile"              // Likely used to log keystrokes to file
        $s4 = "SaveKeyboardLog"        // Possible function for saving logs
        $s5 = "log.txt"                // Output file for keystrokes

    condition:
        2 of ($s*)
}
