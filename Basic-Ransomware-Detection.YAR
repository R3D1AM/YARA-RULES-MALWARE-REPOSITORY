import "pe"


rule Ransomware
{
    meta:
        description = "Detects ransomware based on typical file patterns"
        author = "YourName"
        date = "2024-09-15"
        version = "1.0"

    strings:
        $extension = ".encrypted"                // File extension used by ransomware
        $note1 = "YOUR FILES HAVE BEEN ENCRYPTED" // Ransom note text
        $api1 = "CryptEncrypt"                   // Encryption API
        $api2 = "CryptDecrypt"
        $path = "C:\\Users\\Public\\RansomNote.txt" // Path to ransom note

    condition:
        (uint16(0) == 0x5A4D) and ( // PE file check
        any of ($extension, $note1) or any of ($api1, $api2))
}
