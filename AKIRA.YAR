Akira
{
    meta:
         description = "Detects files or network communication associated with IP 77.247.126.158"
description = description = "Detects exploits related to CVE-2020-3259, CVE-2023-20269, and CVE-2023-27532"
        date = "	Jul 16, 2024, 9:53:59 AM"
        hash = "Replace with known file hash if available"
        reference = "Exploit source"

    strings:
        
strings:
        $ip = "77.247.126.158"
        $cve_1 = "CVE-2020-3259"
        $cve_2 = "CVE-2023-20269"
        $cve_3 = "CVE-2023-27532"

  condition:
        any of ($cve_*)
 condition:
        uint16(0) == 0x5A4D and // Check for PE files (Windows Executable)
        filesize < 10MB and      // Akira ransomware files tend to be smaller
        (
}
        
        // File extension commonly used by Akira Ransomware
        $encrypted_ext = ".akira" ascii
        
        // Encryption-related API calls used by ransomware
        $encrypt_call_1 = "CryptEncrypt" ascii
        $encrypt_call_2 = "CryptAcquireContext" ascii
        $encrypt_call_3 = "CryptImportKey" ascii
        
MD5 Hashes:

0a6757bea01c2c48b50b7ec2bc39e31c
6615ea2fa3b879d27687a7ce917e93b0
77a243cb73f6bdd610eeb10786b752fb
aee6801792d67607f228be8cec8291f9
b87639f9a6cf5ba8c9e1f297c5745a67
SHA1 Hash:
8d4f19b221751297b0c3a10f105772d7286c9411

       // Additional malware-related strings or hex values
        $malicious_string = "AkiraRansom" ascii
        $hex_pattern = { E8 ?? ?? ?? ?? 8B F8 85 C0 74 18 8B }

    condition:
        uint16(0) == 0x5A4D and // Check for PE files (Windows Executable)
        filesize < 10MB and      // Akira ransomware files tend to be smaller
        (
            any of ($ransom_note_*) or        // Look for ransom note strings
            $encrypted_ext or                 // Detect Akira-encrypted files
            any of ($encrypt_call_*) or       // API calls related to encryption
            $malicious_string or              // Detect specific ransomware string
            $hex_pattern                      // Hex pattern found in Akira malware
        )
}

