rule MarioLocker_Ransomware
{
    meta:
        author = "Your Name"
        description = "YARA rule to detect MarioLocker ransomware"
        date = "2023-09-16"
        hash = "Add specific file hash of known samples if available"
        reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.mariolocker"

    strings:
        // Common strings found in MarioLocker samples
        $s1 = "MarioLocker" ascii wide
        $s2 = "/c vssadmin delete shadows /all /quiet" ascii wide
        $s3 = "files have been encrypted" ascii wide
        $s4 = "mariolocker_unlocker.exe" ascii wide
        $s5 = "Your files are encrypted by MarioLocker" ascii wide
        
        // Encryption-related functions
        $enc1 = "CryptEncrypt" ascii wide
        $enc2 = "CryptDecrypt" ascii wide
        $enc3 = "CreateFileA" ascii wide
        $enc4 = "WriteFile" ascii wide

    condition:
        (uint16(0) == 0x5A4D) and ( // Check if the file is a PE (Portable Executable)
            5 of ($s*) or 
            (2 of ($enc*) and filesize < 500KB)
        )
}
